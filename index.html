<!doctype html><html class=no-js lang=en><head><meta name=generator content="Hugo 0.83.1"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title></title><script>(function(a,b){a[b]=a[b].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content="Cifer's Personal blog about everything"><meta property="og:title" content><meta property="og:description" content="Cifer's Personal blog about everything"><meta property="og:type" content="website"><meta property="og:url" content="https://cifer76.github.io/"><meta itemprop=name content><meta itemprop=description content="Cifer's Personal blog about everything"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel=alternate type=application/rss+xml href=/index.xml title><link rel="shortcut icon" href=/favicon.ico><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-48551763-1','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class="logo logo--mixed"><a class=logo__link href=/ title=狂想曲 rel=home><div class="logo__item logo__imagebox"><img class=logo__img src=/logo.png></div><div class="logo__item logo__text"><div class=logo__title>狂想曲</div><div class=logo__tagline>勇敢的灵魂追寻本我</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/investing><span class=menu__text>How to Invest</span></a></li><li class=menu__item><a class=menu__link href=/how-to-learn><span class=menu__text>How to learn new things</span></a></li><li class=menu__item><a class=menu__link href=/reading><span class=menu__text>Readings</span></a></li><li class=menu__item><a class=menu__link href=/eight-part-essay><span class=menu__text>SKILLS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class="main list" role=main><article class="list__item post"><header class=list__header><h2 class="list__title post__title"><a href=/posts/suricata/ rel=bookmark>Suricata Quickstart</a></h2><div class="list__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2021-05-27T00:00:00Z>2021-05-27</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/network-security/ rel=category>Network Security</a></span></div></div></header><div class="content list__excerpt post__content clearfix">1. How to run suricata Just a suricata command with the default configuration should be enough for most caess, to see what the default configurations are, use suricata --build-info, the most important configurations in my macbook are:
Generic build parameters: Installation prefix: /usr/local/Cellar/suricata/6.0.2 Configuration directory: /usr/local/etc/suricata/ Log directory: /usr/local/var/log/suricata/ --prefix /usr/local/Cellar/suricata/6.0.2 --sysconfdir /usr/local/etc --localstatedir /usr/local/var --datarootdir /usr/local/Cellar/suricata/6.0.2/share So we know if we don&rsquo;t specify the config path and the output log path, suricata will read configuration from /usr/local/etc/suricata/ and outputs log to /usr/local/var/log/suricata.</div><div class="list__footer clearfix"><a class="list__footer-readmore btn" href=/posts/suricata/>Read more…</a></div></article><article class="list__item post"><header class=list__header><h2 class="list__title post__title"><a href=/posts/bitcoin-vs-gold/ rel=bookmark>Bitcoin vs Gold</a></h2><div class="list__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2021-05-23T00:00:00Z>2021-05-23</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/investment/ rel=category>Investment</a></span></div></div></header><div class="content list__excerpt post__content clearfix">Market Cap Currently, bitcoin is only 5.7% of the gold&rsquo;s market cap1.
Buffett&rsquo;s opinion on investing gold https://youtu.be/MxvsnEkudfg
All-in sustaining costs (AISC) Costs of mining 1 unit of gold/bitcoin per to https://8marketcap.com.&#160;&#8617;&#xfe0e;</div></article><article class="list__item post"><header class=list__header><h2 class="list__title post__title"><a href=/posts/anaerobic-aerobic-exercise/ rel=bookmark>有氧运动和无氧运动的区别</a></h2><div class="list__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2021-05-22T00:00:00Z>2021-05-22</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/fitness/ rel=category>Fitness</a></span></div></div></header><div class="content list__excerpt post__content clearfix">人体供能 三大 &ldquo;储能&rdquo; 物质:
糖原(碳水化合物) 脂肪(甘油三酯) 蛋白质 中学生物有学过, 细胞活动所需的能量的直接提供者是 ATP. 糖, 脂肪, 蛋白质供能最终都是重重分解转化为 ATP 来供能.
有氧运动和无氧运动的区别 有氧运动就是低强度的持续时间长的不断有氧气参与供能的运动, 无氧运动则是高强度高爆发性的没有氧气参与供能的运动. 这个说法你不难在网上很多地方查到, 但是很少有人对这个说法又进一步的辨析, 比如说俯卧撑是无氧运动, 但是不是只要我一直不断的做, 就也会变成有氧?
答案很明确, 不是. 虽然一直不断的俯卧撑看起来满足了有氧运动持续时间长的特点, 但是更重要的是运动强度, 俯卧撑的特点在于每次下落和撑起时肌肉的爆发性的收缩舒张, 这个过程发生在一瞬间, 氧化供能是跟不上的. 当然随着俯卧撑的时间加长, 有氧供能也一定会参与进来, 但参与进来也不是因为要给肌肉瞬间的收缩供能, 而是给俯卧撑过程中其他的非爆发型的环节功能, 比如加快的呼吸, 持续高翘的屁股等.
实际上任何运动过程都不是纯粹的有氧或者无氧, 有氧和无氧过程从一开始就都会存在, 但关键看运动过程中谁发挥了关键作用. 俯卧撑无氧运动起到关键作用, 因为这个运动的关键点就是卧撑瞬间的力量爆发, 长跑一定也有无氧过程, 否则就不会跑着跑着肌肉酸痛1, 但是令长跑持续下去的关键还是背后糖原和脂肪源源不断的氧化供能.
锻炼肌肉会有助于减肥吗? 答案是肯定的.
减肥是为了减掉多余的脂肪, 脂肪组织是负责储能的, 而肌肉组织却是高能耗组织2, 维持肌肉块所需的能力哪里来呢? 刚吃的饭, 体内储存的糖原都是短暂的, 关键还是要靠脂肪来作为能量后盾.
然而人体是聪明的, 人身上的肌肉只要不经常用, 这部分肌肉就会首先被拿来祭天3, 肌肉没那么多了, 对脂肪的消耗也就少了. 这也是很多人通过节食来减肥但往往效果适得其反的原因, 人们以为节食后身体不能从食物摄能就会转而从脂肪摄能, 殊不知身体会先从肌肉摄能, 然后才是脂肪, 但是因为肌肉也减少了, 需要维持肌肉形态而消耗的脂肪也减少了, 这两部分效用叠加就可能得到脂肪不减反增的效果.
这里一定要提一句, 我们说的 “肌肉是高能耗组织” 指的是肌肉你一定要不断的用它它才是高能耗组织, 也就是不断的锻炼它, 就算你有一腿的肌肉但是不走路也不会耗多少能量一样.</div><div class="list__footer clearfix"><a class="list__footer-readmore btn" href=/posts/anaerobic-aerobic-exercise/>Read more…</a></div></article><article class="list__item post"><header class=list__header><h2 class="list__title post__title"><a href=/posts/gold/ rel=bookmark>Gold Mining</a></h2><div class="list__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2021-05-21T00:00:00Z>2021-05-21</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/investment/ rel=category>Investment</a></span></div></div></header><div class="content list__excerpt post__content clearfix">Relating concepts Gold grade Gold grade is a term used in gold mining, and should be used as a measure of the quality of gold ore – that is the raw material obtained from mining.
The grade of mined, raw gold ore is measured in grams of gold per tonne of ore. High grade gold ore contains more gold per tonne; this means that more gold is obtained from every tonne mined.</div><div class="list__footer clearfix"><a class="list__footer-readmore btn" href=/posts/gold/>Read more…</a></div></article><article class="list__item post"><header class=list__header><h2 class="list__title post__title"><a href=/posts/bid-ask-spread/ rel=bookmark>为什么 bid-ask spread 是做市商的潜在收益</a></h2><div class="list__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2021-05-16T00:00:00Z>2021-05-16</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/investment/ rel=category>Investment</a></span></div></div></header><div class="content list__excerpt post__content clearfix">关于做市商如何挣钱, 这篇文章说的不错: https://www.investopedia.com/terms/m/marketmakerspread.asp
说白了就是低买高卖, bid-ask spread 也就是买一和卖一的价差, 价差越大价差越大, marker 潜在的收益自然就越高. 但是上面文章有一句话没说清楚, 就是这句:
For example, imagine that a market maker MM in a stock – let’s call it Alpha – shows a bid and ask price with a quote of $10.00 - 10.05. This means that this MM is willing to both buy Alpha shares for $10 and sell it at $10.05.
我查了好几篇文章都和这句话说得类似, 就是现在价差是 10.00 - 10.05. 那么 marker 只要 10.</div><div class="list__footer clearfix"><a class="list__footer-readmore btn" href=/posts/bid-ask-spread/>Read more…</a></div></article><article class="list__item post"><header class=list__header><h2 class="list__title post__title"><a href=/posts/ethereum-smart-contract-quickstart/ rel=bookmark>以太坊智能合约快速上手</a></h2><div class="list__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2021-05-11T00:00:00Z>2021-05-11</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/blockchain/ rel=category>Blockchain</a></span></div></div></header><div class="content list__excerpt post__content clearfix">这两天学习以太坊合约开发, 不得不说以太坊社区是真 &ldquo;繁荣&rdquo;, 网上的教程多得数不胜数, 为什么繁荣加引号呢, 因为从这些教程的质量来看就知道, 以太坊社区的繁荣是各自为营, 社区里各式各样的团队各怀鬼胎的搞以太坊的生态建设, 而实际上根本目的都是为了推销自己的 dapp, 试图扩大自己在生态圈里的虚名，做以太坊社区 V 神之下的老二. V 神显然也不想做领袖角色, 社区就让他自由发展吧!
可是官方文档你好歹整好点, 我在官方想找个智能合约的 quickstart 都找不到, 官方文档说两句就丢你给个 remix 或者 truffle 等工具链接让你用那些工具写智能合约. 这不是我想要的, 我想学习的是不借助任何那些花里胡哨的 IDE 怎么把合约部署到主链上, 官方文档却不教你这一点, 没有这个信息, 即使有可能也是某个开发者的个人博客上有介绍(可能也是自己研究之后做个笔记), 而那些花里胡哨的工具的文档只会介绍自己的工具怎么样, 更不会跟你说底层原理.
不得已, 我只能多花了些时间把智能合约的开发部署捋了一遍. 下面我会摈弃虚华的外表, 让你能以最小的学习成本 + 最快的速度完成一个智能合约并发布.
开发环境搭建 环境方面我们需要:
一个趁手的编辑器, 我选 vim 你随意 智能合约的编译器, 我们选择 solcjs 以太坊节点, 我们选择 geth 需要搭建一个测试或者私有网络, 我们选择 rinkeby 测试网络 关于开发环境方面上述 4 点是我摸索出来成本最低最省事而又最接近在主网部署合约的配置, 诸位如果是第一次接触以太坊智能合约开发大可放心按我的方式来.
反观以太坊的官方文档, 看看它是怎么叫我们搭本地开发环境的:
https://ethereum.org/en/developers/local-environment/ 看到了吗, 直接甩给你一堆框架, 谁知道用哪个好, 官方就不能tm多写点自己写个教程吗. 算了, 闲槽少吐, 我们直接开始我们自己的流程.</div><div class="list__footer clearfix"><a class="list__footer-readmore btn" href=/posts/ethereum-smart-contract-quickstart/>Read more…</a></div></article><article class="list__item post"><header class=list__header><h2 class="list__title post__title"><a href=/posts/csprng/ rel=bookmark>CSPRNG 如何做到不可预测</a></h2><div class="list__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2021-05-10T00:00:00Z>2021-05-10</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/programming/ rel=category>Programming</a></span></div></div></header><div class="content list__excerpt post__content clearfix">上一篇文章 我们提到了实现伪随机数生成器 PRNG 的一种经典算法: 线性同余法. 我们也提到了线性同余法由于无法做到不可预测而不能成为密码学安全的算法, 如果对其加以改进使做到不可预测，我们就能够得到密码学安全的随机数生成器 CSPRNG. 本文我们就来看看线性同余法是如何被预测的以及 CSPRNG 是如何克服这一点的.
线性同余为什么是可预测的 线性同余的公示如下, A, C, M 是常数:
$$R_{n+1} = (A \times R_n + C) \bmod M$$1
其中
$$R_0 = (A \times seed + C) \bmod M$$
我们说过不可预测的定义:
即使给出产生序列的算法或硬件和所有以前产生的位序列, 也不可能通过计算来预测下一个随机位是什么.
应用密码学: 协议, 算法与 C 源程序》第 2 版2
线性同余的算法很简单只是一个多项式, 其常数 A, C, M 一般是不公开的, seed 一般也不会让我们知道, 但是显然我们只要知道它生成的 4 个随机数, 就能反推出 A, C, M 以及 seed, 从而整个随机序列我们都能知晓.
CSPRNG 如何做到不可预测 由上述可知线性同余的问题在于容易被反推, 所以首先我们要解决容易反推的问题, 如果做到不被反推呢?</div><div class="list__footer clearfix"><a class="list__footer-readmore btn" href=/posts/csprng/>Read more…</a></div></article><article class="list__item post"><header class=list__header><h2 class="list__title post__title"><a href=/posts/prng/ rel=bookmark>随机数与伪随机数生成器</a></h2><div class="list__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2021-05-09T00:00:00Z>2021-05-09</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/programming/ rel=category>Programming</a></span></div></div></header><div class="content list__excerpt post__content clearfix">想必我们都知道随机数和伪随机数的说法, 但是未必真能说清楚他们二者的区别, 只是隐约的知道伪随机数不是真正的随机数, 但是再往深了说就说不清了. 那今天我们就来深入的研究一下二者的区别.
什么是随机数? 起笔时我才发现还真是很难给出随机数的定义, 于是我搜索了一番, 发现不仅 Google 没有答案, 连我参考的两本密码学的名著也没有明确定义. 奈何这一段的标题都写出来了, 所以我苦思了好几分钟, 认为这一定义还是比较不错的:
不确定的数.
这背后延伸的意思就是, “不被安排” “不是遵循某个规则产生”, 这个定义和英文单词 &ldquo;random&rdquo; 的释义有着异曲同工之妙:
“确定” 和 “不确定” 在物理世界中都是广泛存在的, 比如抛出的硬币确定会落地, 但是哪面朝上就不确定了. 但是对计算机来说, “不确定” 却是不存在的, 因为数学一定是确定的, 计算机就是数学, 计算机里的程序, 算法, 对于确定的输入, 一定会得到确定的输出. 如何让计算机输出不确定的结果? 那就是把外界的不确定作为计算机的输入.
物理世界中的不确定也就是我们所说的真随机(TRNG).
伪随机 由于真随机来自于计算机外部, 获得的代价往往较高, 而在计算机的应用场景中我们也并不总是要求随机数都有真随机那么高的不确定性, 所以这就衍生出了对伪随机的需求. 伪随机由算法产生, 设计良好的算法产生的随机序列能够以假乱真, 产生伪随机数的算法被叫做伪随机数生成器.
伪随机数生成器通常接受一个 seed 用来初始化生成器的初始状态, 后面会看到, 这个 seed 在某些情况下是必须提供的, 在另外一些情况下可以不提供, 但即使是在不需要提供的情况下, 提供 seed 仍然是较好的工程实践1.
随机的三重等级 业界特别是密码学领域将随机分为三个级别:
伪随机 (PRNG) 密码学安全的伪随机 (CSPRNG) 真随机 (TRNG) 伪随机 (PRNG) Pseudo-random number generator</div><div class="list__footer clearfix"><a class="list__footer-readmore btn" href=/posts/prng/>Read more…</a></div></article><article class="list__item post"><header class=list__header><h2 class="list__title post__title"><a href=/posts/year-in-review-2020/ rel=bookmark>2020 年终总结</a></h2><div class="list__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2021-01-02T00:00:00Z>2021-01-02</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/yearinreview/ rel=category>YearInReview</a></span></div></div></header><div class="content list__excerpt post__content clearfix">2020 年终总结 个人性格 始终还是优柔寡断的性格, 2021 年一定要改变这个性格.
工作 对管理有了一些思考, 一个管理者应该具备真正的资源把控能力, 而不应该单纯的就是派活给团队成员, 更不应该是 &ldquo;拿着鞭子&rdquo; 在团队成员后面催工的剥削者. 优秀成熟的管理者应当同时服务好上级和下属, 按时保质的完成上级的任务是当然的, 但是也不要牺牲下属的舒适度. 否则就可能会造成下属在巨大的压力下无法完成任务, 自己也无法向上级交付的尴尬. 个人技能 对 Tor 网络与代理的认识更深了 匿名主机, 匿名域名. 知道了如何在网络上匿名创办网站 加深了对 DNS 的了解 学习了 Rust 语言. 语言很不错, 就是条条框框有点多, 不适合我这种不需要编译器来保证内存安全的高手. 重新拾起了 python 并用 flask 做了个网站. 在一起体会了 &ldquo;人生苦短, 我用 python&rdquo; 的真谛, 因为同样地网站我先用 Rust 语言现学现做花了 10 倍多的时间 学习了 mongodb 数据库的使用, 以后我尽可能都不会再用 mysql 了 了解了如何通过创建 SSH tunnel 来翻墙 学习了怎么创建一个 HTTPS 服务 投资 今年开始学着买了基金和股票, 基金和股票的持仓部分取得了勉强胜过通胀的收益 开通了汇丰香港卡, 美股和港股也有所涉及.</div><div class="list__footer clearfix"><a class="list__footer-readmore btn" href=/posts/year-in-review-2020/>Read more…</a></div></article><article class="list__item post"><header class=list__header><h2 class="list__title post__title"><a href=/posts/rust-singleton/ rel=bookmark>Rust 里的单例模式</a></h2><div class="list__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2020-11-07T00:00:00Z>2020-11-07</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/rust/ rel=category>Rust</a></span></div></div></header><div class="content list__excerpt post__content clearfix">Rust 要想搞个单例模式还真是曲折.
单例模式说到底就是全局变量, 在别的语言很容易实现, 但是在 rust 里则诸多不便, 因为 rust 这门语言从设计上就是要避免使用全局变量的. 实际上 Rust 里就没有全局变量的概念, 只有生命周期的概念, 全局变量某种意义上也就是具有整个运行时周期的静态变量, 如果我们真的要定义全局变量, 那就用 static 关键字. 后面我们姑且不论全局变量和静态变量的区别, 统一用静态变量的说法.
Rust 的 static 关键字和 C/C++ 语言一样, 代表变量的生命周期是整个运行时, 但是相比 C/C++ rust 的 static 有一个限制: 必须使用编译时期能够确定的值初始化. 刚看到着点有点想吐槽, 这不就跟 const 常量有点像了么, 不过一想这应该也是 rust 为了安全考虑, 防止运行时有多处地方想要初始化这个静态变量. 但是给我们造成的麻烦可就不小了, 具体麻烦程度取决于我们需不需随后在运行时修改这静态变量的值, 需要分别讨论.
如果我们运气好不需要运行时修改静态变量, 意味着变量声明不用加 mut, 那就很好, 虽然这种情况其实直接用 const 就行了&mldr; 但总之看起来至此需求满足了, 讨论可以结束? 很遗憾并没有.
往往我们用单例模式都是要和系统资源打交道的, 比如网络连接, 文件描述符等, 这些系统资源当然本身是不支持同步访问的, 需要上层有一种机制保证对他们的访问是同步的. 对于 unmutable 的静态变量, rust 会编译时检查这个变量类型是否本身支持同步访问, 支持则已, 不支持则会报错. 不愧是 rust, 多么的严谨哦~ 那 rust 是怎么检查的呢?</div><div class="list__footer clearfix"><a class="list__footer-readmore btn" href=/posts/rust-singleton/>Read more…</a></div></article></main><div class=pagination><span class="pagination__item pagination__item--current">1/7</span>
<a class="pagination__item pagination__item--next btn" href=/page/2/>»</a></div></div><aside class=sidebar><div class="widget-search widget"><form class=widget-search__form role=search method=get action=https://google.com/search><label><input class=widget-search__field type=search placeholder=SEARCH… name=q aria-label=SEARCH…></label>
<input class=widget-search__submit type=submit value=Search>
<input type=hidden name=sitesearch value=https://cifer76.github.io/></form></div><div class="widget-recent widget"><h4 class=widget__title>Recent Posts</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=/posts/suricata/>Suricata Quickstart</a></li><li class=widget__item><a class=widget__link href=/posts/bitcoin-vs-gold/>Bitcoin vs Gold</a></li><li class=widget__item><a class=widget__link href=/posts/anaerobic-aerobic-exercise/>有氧运动和无氧运动的区别</a></li><li class=widget__item><a class=widget__link href=/posts/gold/>Gold Mining</a></li><li class=widget__item><a class=widget__link href=/posts/bid-ask-spread/>为什么 bid-ask spread 是做市商的潜在收益</a></li></ul></div></div><div class="widget-categories widget"><h4 class=widget__title>Categories</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=/categories/algorithm/>Algorithm</a>&nbsp;
<span class="widget__counter widget__counter--bubble">3</span></li><li class=widget__item><a class=widget__link href=/categories/bitcoin/>Bitcoin</a>&nbsp;
<span class="widget__counter widget__counter--bubble">7</span></li><li class=widget__item><a class=widget__link href=/categories/blockchain/>Blockchain</a>&nbsp;
<span class="widget__counter widget__counter--bubble">6</span></li><li class=widget__item><a class=widget__link href=/categories/c/>C</a>&nbsp;
<span class="widget__counter widget__counter--bubble">1</span></li><li class=widget__item><a class=widget__link href=/categories/commerce/>Commerce</a>&nbsp;
<span class="widget__counter widget__counter--bubble">1</span></li><li class=widget__item><a class=widget__link href=/categories/fitness/>Fitness</a>&nbsp;
<span class="widget__counter widget__counter--bubble">1</span></li><li class=widget__item><a class=widget__link href=/categories/freertos/>FreeRTOS</a>&nbsp;
<span class="widget__counter widget__counter--bubble">1</span></li><li class=widget__item><a class=widget__link href=/categories/investment/>Investment</a>&nbsp;
<span class="widget__counter widget__counter--bubble">3</span></li><li class=widget__item><a class=widget__link href=/categories/knowledge/>Knowledge</a>&nbsp;
<span class="widget__counter widget__counter--bubble">1</span></li><li class=widget__item><a class=widget__link href=/categories/linux/>Linux</a>&nbsp;
<span class="widget__counter widget__counter--bubble">7</span></li><li class=widget__item><a class=widget__link href=/categories/network-security/>Network Security</a>&nbsp;
<span class="widget__counter widget__counter--bubble">1</span></li><li class=widget__item><a class=widget__link href=/categories/networking/>Networking</a>&nbsp;
<span class="widget__counter widget__counter--bubble">1</span></li><li class=widget__item><a class=widget__link href=/categories/nginx/>Nginx</a>&nbsp;
<span class="widget__counter widget__counter--bubble">1</span></li><li class=widget__item><a class=widget__link href=/categories/php/>PHP</a>&nbsp;
<span class="widget__counter widget__counter--bubble">1</span></li><li class=widget__item><a class=widget__link href=/categories/programming/>Programming</a>&nbsp;
<span class="widget__counter widget__counter--bubble">8</span></li><li class=widget__item><a class=widget__link href=/categories/python/>Python</a>&nbsp;
<span class="widget__counter widget__counter--bubble">2</span></li><li class=widget__item><a class=widget__link href=/categories/reading/>Reading</a>&nbsp;
<span class="widget__counter widget__counter--bubble">3</span></li><li class=widget__item><a class=widget__link href=/categories/redis/>Redis</a>&nbsp;
<span class="widget__counter widget__counter--bubble">1</span></li><li class=widget__item><a class=widget__link href=/categories/rust/>Rust</a>&nbsp;
<span class="widget__counter widget__counter--bubble">1</span></li><li class=widget__item><a class=widget__link href=/categories/sdn/>SDN</a>&nbsp;
<span class="widget__counter widget__counter--bubble">4</span></li><li class=widget__item><a class=widget__link href=/categories/web/>Web</a>&nbsp;
<span class="widget__counter widget__counter--bubble">6</span></li><li class=widget__item><a class=widget__link href=/categories/yearinreview/>YearInReview</a>&nbsp;
<span class="widget__counter widget__counter--bubble">3</span></li><li class=widget__item><a class=widget__link href=/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F/>嵌入式</a>&nbsp;
<span class="widget__counter widget__counter--bubble">1</span></li><li class=widget__item><a class=widget__link href=/categories/%E8%81%8C%E4%B8%9A/>职业</a>&nbsp;
<span class="widget__counter widget__counter--bubble">1</span></li></ul></div></div><div class="widget-taglist widget"><h4 class=widget__title>Tags</h4><div class=widget__content><a class="widget-taglist__link widget__link btn" href=/tags/algorithm/ title=algorithm>algorithm</a>
<a class="widget-taglist__link widget__link btn" href=/tags/async-io/ title="async io">async io</a>
<a class="widget-taglist__link widget__link btn" href=/tags/aws/ title=aws>aws</a>
<a class="widget-taglist__link widget__link btn" href=/tags/binary-tree/ title="binary tree">binary tree</a>
<a class="widget-taglist__link widget__link btn" href=/tags/bitcoin/ title=bitcoin>bitcoin</a>
<a class="widget-taglist__link widget__link btn" href=/tags/c/ title=C>C</a>
<a class="widget-taglist__link widget__link btn" href=/tags/c++/ title=C++>C++</a>
<a class="widget-taglist__link widget__link btn" href=/tags/c-programming/ title="C Programming">C Programming</a>
<a class="widget-taglist__link widget__link btn" href=/tags/centos/ title=centos>centos</a>
<a class="widget-taglist__link widget__link btn" href=/tags/cgi/ title=cgi>cgi</a>
<a class="widget-taglist__link widget__link btn" href=/tags/commerce/ title=commerce>commerce</a>
<a class="widget-taglist__link widget__link btn" href=/tags/coroutine/ title=coroutine>coroutine</a>
<a class="widget-taglist__link widget__link btn" href=/tags/csprng/ title=CSPRNG>CSPRNG</a>
<a class="widget-taglist__link widget__link btn" href=/tags/dfs/ title=DFS>DFS</a>
<a class="widget-taglist__link widget__link btn" href=/tags/dpos/ title=dpos>dpos</a>
<a class="widget-taglist__link widget__link btn" href=/tags/electrum/ title=Electrum>Electrum</a>
<a class="widget-taglist__link widget__link btn" href=/tags/encoding/ title=encoding>encoding</a>
<a class="widget-taglist__link widget__link btn" href=/tags/ethereum/ title=Ethereum>Ethereum</a>
<a class="widget-taglist__link widget__link btn" href=/tags/fastcgi/ title=fastcgi>fastcgi</a>
<a class="widget-taglist__link widget__link btn" href=/tags/fitness/ title=fitness>fitness</a>
<a class="widget-taglist__link widget__link btn" href=/tags/gnu-screen/ title="gnu screen">gnu screen</a>
<a class="widget-taglist__link widget__link btn" href=/tags/hp-%E5%B0%8F%E5%9E%8B%E6%9C%BA/ title="HP 小型机">HP 小型机</a>
<a class="widget-taglist__link widget__link btn" href=/tags/indigo/ title=Indigo>Indigo</a>
<a class="widget-taglist__link widget__link btn" href=/tags/jit/ title=JIT>JIT</a>
<a class="widget-taglist__link widget__link btn" href=/tags/kernel/ title=kernel>kernel</a>
<a class="widget-taglist__link widget__link btn" href=/tags/leetcode/ title=leetcode>leetcode</a>
<a class="widget-taglist__link widget__link btn" href=/tags/linux/ title=linux>linux</a>
<a class="widget-taglist__link widget__link btn" href=/tags/market-marker/ title=market-marker>market-marker</a>
<a class="widget-taglist__link widget__link btn" href=/tags/mount/ title=mount>mount</a>
<a class="widget-taglist__link widget__link btn" href=/tags/network-security/ title="network security">network security</a>
<a class="widget-taglist__link widget__link btn" href=/tags/nginx/ title=nginx>nginx</a>
<a class="widget-taglist__link widget__link btn" href=/tags/openflow/ title=OpenFlow>OpenFlow</a>
<a class="widget-taglist__link widget__link btn" href=/tags/openjtag/ title=openjtag>openjtag</a>
<a class="widget-taglist__link widget__link btn" href=/tags/openocd/ title=openocd>openocd</a>
<a class="widget-taglist__link widget__link btn" href=/tags/pam/ title=pam>pam</a>
<a class="widget-taglist__link widget__link btn" href=/tags/pathinfo/ title=pathinfo>pathinfo</a>
<a class="widget-taglist__link widget__link btn" href=/tags/pbft/ title=PBFT>PBFT</a>
<a class="widget-taglist__link widget__link btn" href=/tags/pcduino/ title=pcduino>pcduino</a>
<a class="widget-taglist__link widget__link btn" href=/tags/php/ title=php>php</a>
<a class="widget-taglist__link widget__link btn" href=/tags/pptp/ title=PPTP>PPTP</a>
<a class="widget-taglist__link widget__link btn" href=/tags/privacy/ title=privacy>privacy</a>
<a class="widget-taglist__link widget__link btn" href=/tags/prng/ title=PRNG>PRNG</a>
<a class="widget-taglist__link widget__link btn" href=/tags/programming/ title=programming>programming</a>
<a class="widget-taglist__link widget__link btn" href=/tags/python/ title=python>python</a>
<a class="widget-taglist__link widget__link btn" href=/tags/quick-sort/ title=quick-sort>quick-sort</a>
<a class="widget-taglist__link widget__link btn" href=/tags/redhat/ title=redhat>redhat</a>
<a class="widget-taglist__link widget__link btn" href=/tags/redis/ title=redis>redis</a>
<a class="widget-taglist__link widget__link btn" href=/tags/rhel/ title=rhel>rhel</a>
<a class="widget-taglist__link widget__link btn" href=/tags/rust/ title=rust>rust</a>
<a class="widget-taglist__link widget__link btn" href=/tags/ryu/ title=Ryu>Ryu</a>
<a class="widget-taglist__link widget__link btn" href=/tags/scgi/ title=SCGI>SCGI</a>
<a class="widget-taglist__link widget__link btn" href=/tags/sdn/ title=SDN>SDN</a>
<a class="widget-taglist__link widget__link btn" href=/tags/segwit/ title=segwit>segwit</a>
<a class="widget-taglist__link widget__link btn" href=/tags/smart-contracts/ title="smart contracts">smart contracts</a>
<a class="widget-taglist__link widget__link btn" href=/tags/solidity/ title=Solidity>Solidity</a>
<a class="widget-taglist__link widget__link btn" href=/tags/suricata/ title=suricata>suricata</a>
<a class="widget-taglist__link widget__link btn" href=/tags/ubuntu/ title=ubuntu>ubuntu</a>
<a class="widget-taglist__link widget__link btn" href=/tags/unicode/ title=unicode>unicode</a>
<a class="widget-taglist__link widget__link btn" href=/tags/vpn/ title=VPN>VPN</a>
<a class="widget-taglist__link widget__link btn" href=/tags/wsgi/ title=WSGI>WSGI</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E5%B5%8C%E5%85%A5%E5%BC%8F/ title=嵌入式>嵌入式</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E7%BF%BB%E8%AF%91/ title=翻译>翻译</a></div></div><div class="widget-social widget"><h4 class="widget-social__title widget__title">Social</h4><div class="widget-social__content widget__content"><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=Twitter rel="noopener noreferrer" href=https://twitter.com/0x76i target=_blank><svg class="widget-social__link-icon icon icon-twitter" width="24" height="24" viewBox="0 0 384 312"><path d="m384 36.9c-14.1 6.3-29.3 10.5-45.2 12.4 16.3-9.7 28.8-25.2 34.6-43.6-15.2 9-32.1 15.6-50 19.1-14.4-15.2-34.9-24.8-57.5-24.8-43.5.0-78.8 35.3-78.8 78.8.0 6.2.7 12.2 2 17.9-65.5-3.3-123.5-34.6-162.4-82.3C20 26 16.1 39.6 16.1 54c0 27.3 13.9 51.4 35 65.6-12.9-.4-25.1-4-35.7-9.9v1c0 38.2 27.2 70 63.2 77.2-6.6 1.8-13.6 2.8-20.8 2.8-5.1.0-10-.5-14.8-1.4 10 31.3 39.1 54.1 73.6 54.7-27 21.1-60.9 33.7-97.8 33.7-6.4.0-12.6-.4-18.8-1.1C34.9 299 76.3 312 120.8 312c144.9.0 224.1-120 224.1-224.1.0-3.4-.1-6.8-.2-10.2 15.4-11.1 28.7-25 39.3-40.8z"/></svg><span>Twitter</span></a></div><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=GitHub rel="noopener noreferrer" href=https://github.com/cifer76 target=_blank><svg class="widget-social__link-icon icon icon-github" width="24" height="24" viewBox="0 0 384 374"><path d="m192 0C85.9.0.0 85.8.0 191.7c0 84.7 55 156.6 131.3 181.9 9.6 1.8 13.1-4.2 13.1-9.2.0-4.6-.2-16.6-.3-32.6-53.4 11.6-64.7-25.7-64.7-25.7-8.7-22.1-21.3-28-21.3-28-17.4-11.9 1.3-11.6 1.3-11.6 19.3 1.4 29.4 19.8 29.4 19.8 17.1 29.3 44.9 20.8 55.9 15.9 1.7-12.4 6.7-20.8 12.2-25.6-42.6-4.8-87.5-21.3-87.5-94.8.0-20.9 7.5-38 19.8-51.4-2-4.9-8.6-24.3 1.9-50.7.0.0 16.1-5.2 52.8 19.7 15.3-4.2 31.7-6.4 48.1-6.5 16.3.1 32.7 2.2 48.1 6.5 36.7-24.8 52.8-19.7 52.8-19.7 10.5 26.4 3.9 45.9 1.9 50.7 12.3 13.4 19.7 30.5 19.7 51.4.0 73.7-44.9 89.9-87.7 94.6 6.9 5.9 13 17.6 13 35.5.0 25.6-.2 46.3-.2 52.6.0 5.1 3.5 11.1 13.2 9.2C329 348.2 384 276.4 384 191.7 384 85.8 298 0 192 0z"/></svg><span>GitHub</span></a></div><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=Email href=mailto:mantianyu@gmail.com><svg class="widget-social__link-icon icon icon-mail" width="24" height="24" viewBox="0 0 416 288"><path d="m0 16v256 16h16 384 16v-16V16 0h-16H16 0zm347 16-139 92.5L69 32zM199 157.5l9 5.5 9-5.5L384 46v210H32V46z"/></svg><span>mantianyu@gmail.com</span></a></div></div></div></aside></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2021 Cifer.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>