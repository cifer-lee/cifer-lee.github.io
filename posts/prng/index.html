<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>随机数与伪随机数生成器 -</title><script>(function(a,b){a[b]=a[b].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content="随机数 伪随机数生成器"><meta property="og:title" content="随机数与伪随机数生成器"><meta property="og:description" content="随机数 伪随机数生成器"><meta property="og:type" content="article"><meta property="og:url" content="/posts/prng/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-05-09T00:00:00+00:00"><meta property="article:modified_time" content="2021-05-09T00:00:00+00:00"><meta itemprop=name content="随机数与伪随机数生成器"><meta itemprop=description content="随机数 伪随机数生成器"><meta itemprop=datePublished content="2021-05-09T00:00:00+00:00"><meta itemprop=dateModified content="2021-05-09T00:00:00+00:00"><meta itemprop=wordCount content="212"><meta itemprop=keywords content="PRNG,"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-48551763-1','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class="logo logo--mixed"><a class=logo__link href=/ title=狂想曲 rel=home><div class="logo__item logo__imagebox"><img class=logo__img src=/logo.png></div><div class="logo__item logo__text"><div class=logo__title>狂想曲</div><div class=logo__tagline>勇敢的灵魂追寻本我</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/reading/><span class=menu__text>书单</span></a></li><li class=menu__item><a class=menu__link href=/eight-part-essay/><span class=menu__text>技能树</span></a></li><li class=menu__item><a class=menu__link href=/investingrule/><span class=menu__text>投资理念</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>随机数与伪随机数生成器</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2021-05-09T00:00:00Z>2021-05-09</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/programming/ rel=category>Programming</a></span></div></div></header><div class="post__toc toc"><div class=toc__title>Page content</div><div class=toc__menu><nav id=TableOfContents><ul><li><a href=#什么是随机数>什么是随机数?</a></li><li><a href=#伪随机>伪随机</a><ul><li><a href=#随机的三重等级>随机的三重等级</a></li><li><a href=#伪随机-prng>伪随机 (PRNG)</a></li><li><a href=#密码学安全的伪随机-csprng>密码学安全的伪随机 (CSPRNG)</a></li></ul></li><li><a href=#真随机>真随机</a></li></ul></nav></div></div><div class="content post__content clearfix"><p>想必我们都知道随机数和伪随机数的说法, 但是未必真能说清楚他们二者的区别, 只是隐约的知道伪随机数不是真正的随机数, 但是再往深了说就说不清了. 那今天我们就来深入的研究一下二者的区别.</p><h2 id=什么是随机数>什么是随机数?</h2><p>起笔时我才发现还真是很难给出随机数的定义, 于是我搜索了一番, 发现不仅 Google 没有答案, 连我参考的两本密码学的名著也没有明确定义. 奈何这一段的标题都写出来了, 所以我苦思了好几分钟, 认为这一定义还是比较不错的:</p><p><strong>不确定的数</strong>.</p><p>这背后延伸的意思就是, “不被安排” “不是遵循某个规则产生”, 这个定义和英文单词 &ldquo;random&rdquo; 的释义有着异曲同工之妙:</p><p><img src=random.png alt></p><p>“确定” 和 “不确定” 在物理世界中都是广泛存在的, 比如抛出的硬币确定会落地, 但是哪面朝上就不确定了. 但是对计算机来说, “不确定” 却是不存在的, 因为数学一定是确定的, 计算机就是数学, 计算机里的程序, 算法, 对于确定的输入, 一定会得到确定的输出. 如何让计算机输出不确定的结果? 那就是把外界的不确定作为计算机的输入.</p><p>物理世界中的不确定也就是我们所说的<strong>真随机(TRNG)</strong>.</p><h2 id=伪随机>伪随机</h2><p>由于真随机来自于计算机外部, 获得的代价往往较高, 而在计算机的应用场景中我们也并不总是要求随机数都有真随机那么高的不确定性, 所以这就衍生出了对伪随机的需求. 伪随机由算法产生, 设计良好的算法产生的随机序列能够以假乱真, 产生伪随机数的算法被叫做伪随机数生成器.</p><p>伪随机数生成器通常接受一个 seed 用来初始化生成器的初始状态, 后面会看到, 这个 seed 在某些情况下是必须提供的, 在另外一些情况下可以不提供, 但即使是在不需要提供的情况下, 提供 seed 仍然是较好的工程实践[^1].</p><h3 id=随机的三重等级>随机的三重等级</h3><p>业界特别是密码学领域将随机分为三个级别:</p><ol><li>伪随机 (PRNG)</li><li>密码学安全的伪随机 (CSPRNG)</li><li>真随机 (TRNG)</li></ol><h3 id=伪随机-prng>伪随机 (PRNG)</h3><p>Pseudo-random number generator</p><p>通常情况下伪随机数生成器产生的随机数属于第一个等级, 这个等级只要求产生的随机数满足统计意义上的随机. 就是说假如伪随机数生成器不断的生成 0, 1 两个数字, 那么这两个数字出现的概率应当是一样的, 也就是生成 1w 次以后, 0 和 1 出现的次数应该基本各占 5k 次.</p><p>最简单的伪随机数生成器莫过于如下所示了.</p><pre><code>int random() {
    static int i = 0;
    return i++ % 2;
}
</code></pre><p>这个生成器完美符合统计意义的随机的条件, 但无疑太挫了, 它的周期只有 2(0, 1, 0, 1, 0, 1, &mldr;), 工程中不会有人真的用这种生成器.</p><p>工程中伪随机生成器通常会使用<strong>线性同余</strong>法这种算法, 包括 C 语言的 srand/rand 库函数以及 java.util.Random 等. 它们的<strong>周期足够大</strong>, 以致于能够达到以假乱真的程度. 然而要注意, 线性同余法的结果就算看着再以假乱真, 那也是假的, 真不过是周期足够大而已, 当生成的数字多到一定程度, 一定会重复之前的结果. (可自行用 C 库中的 srand/rand 测试)</p><h3 id=密码学安全的伪随机-csprng>密码学安全的伪随机 (CSPRNG)</h3><p>Crypto security pseudo-random number generator</p><p>密码学领域是随机数应用的重要领域, 而单纯的伪随机这个级别是满足不了密码学对随机的要求的. 在统计意义的随机的基础上, 密码学还要求伪随机生成器所生成的数字是不可预测的. 不可预测的意思是说:</p><blockquote><p>即使给出产生序列的算法或硬件和所有以前产生的位序列, 也不可能通过计算来预测下一个随机位是什么.</p><p>《应用密码学: 协议, 算法与 C 源程序》第 2 版[^2]</p></blockquote><p>上述线形同余伪随机生成器的算法肯定是不满足这个条件的, 因为线性公式算法是非常容易反推的. 通常 CSPRNG 首先会借助单向散列函数来阻止黑客反推生成器的内部状态, 其次会不断变化 seed 来增加黑客分析已有序列的规律的难度.</p><p>关于普通的 PRNG 为什么不安全以及 CSPRNG 如何解决安全问题, 有些细节可以讲, 后面再写个文章专门介绍.</p><h2 id=真随机>真随机</h2><p>真随机就是文首所阐述的物理世界的随机了, 真随机要求在前两个级别的基础上, 进一步要求 “不可重现” 的特性, 它的定义是:</p><blockquote><p>用完全同样的输入对生成器操作两次, 你将得到两个不相关的随机序列.</p><p>《应用密码学: 协议, 算法与 C 源程序》第 2 版</p></blockquote><p>PRNG 还是 CSPRNG 当然不具备这个特性, 因为他们都是算法实现, 在同样的输入下运行, 得到的一定是同样的输出. 用冯诺依曼的话说就是 “任何考虑用数学的方法生成真随机数肯定是扯淡”, 算法就是数学。</p><p>只有文首对来自物理世界中的随机数的叙述才算是真随机. 比如同一地点抛硬币 5 次, 得到一个序列, 再抛硬币 5 次又得到一个序列. 两次抛硬币的外界输入是一样的, 但两个序列的结果是不一样的, 这就是不可重现.</p><hr><p>[^1]. <a href=https://stats.stackexchange.com/a/354377/320904>https://stats.stackexchange.com/a/354377/320904</a>
[^2]. <a href=https://book.douban.com/subject/25772389/>https://book.douban.com/subject/25772389/</a></p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/prng/ rel=tag>PRNG</a></li></ul></div></footer></article></main><div class="authorbox clearfix"><div class=authorbox__header><span class=authorbox__name>About Cifer</span></div></div><nav class="pager flex"><div class="pager__item pager__item--prev"><a class=pager__link href=/posts/year-in-review-2020/ rel=prev><span class=pager__subtitle>«&#8201;Previous</span><p class=pager__title>2020 年终总结</p></a></div><div class="pager__item pager__item--next"><a class=pager__link href=/posts/ethereum-smart-contract-quickstart/ rel=next><span class=pager__subtitle>Next&#8201;»</span><p class=pager__title>以太坊智能合约快速上手</p></a></div></nav><section class=comments><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//justforfree.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2021 Cifer.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script></body></html>